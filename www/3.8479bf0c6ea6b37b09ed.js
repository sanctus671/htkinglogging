(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"N+xg":function(n,e,t){"use strict";t.r(e);var l=t("CcnG"),o=function(){return function(){}}(),i=t("pMnS"),u=t("oBZk"),c=t("ZZ/e"),r=t("Ip0R"),a=t("lXZ+"),d=t("ZYCi"),s=t("gIcY"),f=t("IwxM"),m=t("ri4K"),p=t("9B/o"),g=t("KOTj"),h=t("0UgC"),D=t("wd/R"),v=t("t8sF"),b=t("wMzM"),C=function(){function n(n,e,t,l,o,i,u,c,r,a,d,s,f){var m=this;this.documentService=n,this.toastController=e,this.modalController=t,this.router=l,this.authenticationService=o,this.alertCtrl=i,this.ngZone=u,this.iab=c,this.offlineService=r,this.file=a,this.fileOpener=d,this.platform=s,this.messageService=f,this.loading=!0,this.search="",this.filters={orderby:"created_at",order:"asc",city:"",suburb:""},this.documents=[],this.documentGroups=[],this.formattedDocuments={},this.user={},this.authenticationService.getUserData().subscribe((function(n){m.ngZone.run((function(){m.user=n}))})),this.offlineService.monitorUploads().subscribe((function(n){n&&n.uploaded&&m.getDocuments()})),this.messageService.getMessageReceived().subscribe((function(n){m.ngZone.run((function(){n&&(n.unread||0===n.unread)&&(m.unreadMessages=n.unread)}))})),this.messageService.getMessages().then((function(){})).catch((function(n){}))}return n.prototype.ionViewDidEnter=function(){this.getDocuments()},n.prototype.downloadDocument=function(n){var e=this;n.file_blob?this.openSavedDocument(n):n.offline_compatible?this.offlineService.getDocument(n.id).then((function(t){t&&t.file_blob?(n.file_blob=t.file_blob,e.openSavedDocument(n)):e.openExternalDocument(n)})).catch((function(t){e.openExternalDocument(n)})):this.openExternalDocument(n)},n.prototype.openSavedDocument=function(n){var e=this,t=this.b64toBlob(n.file_blob,"application/pdf",512),l=new Blob([t],{type:"application/pdf"}),o=this.platform.is("ios")?this.file.dataDirectory:this.file.externalApplicationStorageDirectory;this.file.writeFile(o,n.id+".pdf",l,{replace:!0}).then((function(t){e.fileOpener.showOpenWithDialog(o+n.id+".pdf","application/pdf").then((function(n){})).catch((function(n){alert(JSON.stringify(n))}))})).catch((function(n){alert(JSON.stringify(n))}))},n.prototype.openExternalDocument=function(n){this.platform.is("android")?this.iab.create(encodeURI("https://docs.google.com/viewer?embedded=true&url="+n.file),"_system","location=yes,enableViewportScale=yes,hidden=no"):this.iab.create(n.file,"_system")},n.prototype.b64toBlob=function(n,e,t){e=e||"",t=t||512,n=(n=n.replace(/^[^,]+,/,"")).replace(/\s/g,"");for(var l=atob(n),o=[],i=0;i<l.length;i+=t){for(var u=l.slice(i,i+t),c=new Array(u.length),r=0;r<u.length;r++)c[r]=u.charCodeAt(r);var a=new Uint8Array(c);o.push(a)}return new Blob(o,{type:e})},n.prototype.getDocuments=function(){var n=this;this.loading=!0,this.offlineService.getDocumentGroups().then((function(e){e?n.setDocumentGroupData(e):n.getOnlineDocuments()})).catch((function(){n.getOnlineDocuments()}))},n.prototype.getOnlineDocuments=function(){var n=this;this.documentService.getDocumentGroups().then((function(e){n.offlineService.saveDocumentGroups(e),n.setDocumentGroupData(e)})).catch((function(){n.loading=!1}))},n.prototype.setDocumentGroupData=function(n){var e=this;this.documentGroups=n,this.documentGroups.push({name:"Other"}),this.formattedDocuments={};for(var t=0,l=this.documentGroups;t<l.length;t++)this.formattedDocuments[l[t].name]=[];this.offlineService.getDocuments().then((function(n){n?(e.setDocumentData(n),e.loading=!1):e.getOnlineDocumentGroupData()})).catch((function(){e.getOnlineDocumentGroupData()}))},n.prototype.getOnlineDocumentGroupData=function(){var n=this;this.documentService.getDocuments(this.search,this.filters).then((function(e){n.formattedDocuments={};for(var t=0,l=n.documentGroups;t<l.length;t++)n.formattedDocuments[l[t].name]=[];var o=e.data;n.offlineService.saveDocuments(e.data),n.setDocumentData(e.data),n.loading=!1,n.toastController.create({message:"Documents are being downloaded...",position:"bottom"}).then((function(e){n.loader=e,e.present(),n.downloadDocumentAPI(o,0)}))})).catch((function(){n.loading=!1}))},n.prototype.setDocumentData=function(n){this.documents=n;for(var e=0,t=this.documents;e<t.length;e++){var l=t[e];l.document_group?this.formattedDocuments[l.document_group.name].push(l):this.formattedDocuments.Other.push(l)}},n.prototype.downloadDocumentAPI=function(n,e){var t=this;if(e!==n.length){var l=n[e];this.loader.message="Downloading "+(e+1)+"/"+n.length+" documents...",l.offline_compatible?this.documentService.getDocument(l.id,"").then((function(l){e+=1,l&&l.file_blob?(e+=1,t.offlineService.saveDocument(l).then((function(){t.downloadDocumentAPI(n,e)})).catch((function(){t.downloadDocumentAPI(n,e)}))):t.downloadDocumentAPI(n,e)})).catch((function(){t.downloadDocumentAPI(n,e+=1)})):this.downloadDocumentAPI(n,e+=1)}else{this.loader.dismiss();var o=-(new Date).getTimezoneOffset(),i=D().add(-o,"m").format("YYYY-MM-DD");this.offlineService.saveDocumentsLastSyncedAt(i)}},n.prototype.doSearch=function(){},n.prototype.documentatDate=function(n){var e=-(new Date).getTimezoneOffset();return D(n).add(e,"m").format("DD/MM/YYYY, h:mma")},n}(),R=l["\u0275crt"]({encapsulation:0,styles:[["ion-toolbar[_ngcontent-%COMP%]   .notification-icon-button[_ngcontent-%COMP%]{--overflow:visible}ion-toolbar[_ngcontent-%COMP%]   .notification-icon-button[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{position:absolute;background:#f70b0b;border-radius:50%;opacity:.9;top:.1rem;right:.2rem}.documents.ios[_ngcontent-%COMP%]   .documents__search[_ngcontent-%COMP%]   .documents__search__filter[_ngcontent-%COMP%]{top:12px}.documents[_ngcontent-%COMP%]   .documents__search[_ngcontent-%COMP%]{position:relative;margin-top:10px}.documents[_ngcontent-%COMP%]   .documents__search[_ngcontent-%COMP%]   .documents__search__filter[_ngcontent-%COMP%]{position:absolute;top:7px;right:10px;font-size:10px}.documents[_ngcontent-%COMP%]   .documents__list[_ngcontent-%COMP%]{margin-top:15px}.documents[_ngcontent-%COMP%]   .documents__list[_ngcontent-%COMP%]   ion-list-header[_ngcontent-%COMP%]{font-weight:600}.documents[_ngcontent-%COMP%]   .documents__loading[_ngcontent-%COMP%]{text-align:center;margin-top:60px}"]],data:{}});function _(n){return l["\u0275vid"](0,[(n()(),l["\u0275eld"](0,0,null,null,2,"ion-badge",[["color","danger"]],null,null,null,u.I,u.d)),l["\u0275did"](1,49152,null,0,c.j,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{color:[0,"color"]},null),(n()(),l["\u0275ted"](2,0,["",""]))],(function(n,e){n(e,1,0,"danger")}),(function(n,e){n(e,2,0,e.component.unreadMessages)}))}function w(n){return l["\u0275vid"](0,[(n()(),l["\u0275eld"](0,0,null,null,2,"div",[["class","documents__loading"]],null,null,null,null,null)),(n()(),l["\u0275eld"](1,0,null,null,1,"ion-spinner",[["color","primary"]],null,null,null,u.db,u.y)),l["\u0275did"](2,49152,null,0,c.sb,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{color:[0,"color"]},null)],(function(n,e){n(e,2,0,"primary")}),null)}function y(n){return l["\u0275vid"](0,[(n()(),l["\u0275eld"](0,0,null,null,7,"ion-item",[["detail",""]],null,[[null,"click"]],(function(n,e,t){var l=!0;return"click"===e&&(l=!1!==n.component.downloadDocument(n.context.$implicit)&&l),l}),u.S,u.n)),l["\u0275did"](1,49152,null,0,c.H,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{detail:[0,"detail"]},null),(n()(),l["\u0275eld"](2,0,null,0,5,"ion-label",[],null,null,null,u.T,u.o)),l["\u0275did"](3,49152,null,0,c.N,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],null,null),(n()(),l["\u0275eld"](4,0,null,0,1,"h2",[],null,null,null,null,null)),(n()(),l["\u0275ted"](5,null,["",""])),(n()(),l["\u0275eld"](6,0,null,0,1,"p",[],null,null,null,null,null)),(n()(),l["\u0275ted"](7,null,["",""]))],(function(n,e){n(e,1,0,"")}),(function(n,e){n(e,5,0,e.context.$implicit.name),n(e,7,0,e.context.$implicit.description)}))}function O(n){return l["\u0275vid"](0,[(n()(),l["\u0275eld"](0,0,null,null,7,"ion-list",[["class","documents__list"]],null,null,null,u.V,u.p)),l["\u0275did"](1,49152,null,0,c.O,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],null,null),(n()(),l["\u0275eld"](2,0,null,0,2,"ion-list-header",[],null,null,null,u.U,u.q)),l["\u0275did"](3,49152,null,0,c.P,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],null,null),(n()(),l["\u0275ted"](4,0,[" "," "])),(n()(),l["\u0275and"](16777216,null,0,2,null,y)),l["\u0275did"](6,278528,null,0,r.i,[l.ViewContainerRef,l.TemplateRef,l.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),l["\u0275ppd"](7,2)],(function(n,e){var t=e.component,o=l["\u0275unv"](e,6,0,n(e,7,0,l["\u0275nov"](e.parent.parent.parent,0),t.formattedDocuments[e.parent.context.$implicit.name],t.search));n(e,6,0,o)}),(function(n,e){n(e,4,0,e.parent.context.$implicit.name)}))}function M(n){return l["\u0275vid"](0,[(n()(),l["\u0275eld"](0,0,null,null,2,"div",[],null,null,null,null,null)),(n()(),l["\u0275and"](16777216,null,null,1,null,O)),l["\u0275did"](2,16384,null,0,r.j,[l.ViewContainerRef,l.TemplateRef],{ngIf:[0,"ngIf"]},null)],(function(n,e){var t=e.component;n(e,2,0,t.formattedDocuments[e.context.$implicit.name]&&t.formattedDocuments[e.context.$implicit.name].length>0)}),null)}function E(n){return l["\u0275vid"](0,[(n()(),l["\u0275eld"](0,0,null,null,2,"div",[],null,null,null,null,null)),(n()(),l["\u0275and"](16777216,null,null,1,null,M)),l["\u0275did"](2,278528,null,0,r.i,[l.ViewContainerRef,l.TemplateRef,l.IterableDiffers],{ngForOf:[0,"ngForOf"]},null)],(function(n,e){n(e,2,0,e.component.documentGroups)}),null)}function P(n){return l["\u0275vid"](0,[l["\u0275pid"](0,a.a,[]),(n()(),l["\u0275eld"](1,0,null,null,24,"ion-header",[],null,null,null,u.P,u.k)),l["\u0275did"](2,49152,null,0,c.B,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],null,null),(n()(),l["\u0275eld"](3,0,null,0,22,"ion-toolbar",[["color","primary"]],null,null,null,u.jb,u.E)),l["\u0275did"](4,49152,null,0,c.Cb,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{color:[0,"color"]},null),(n()(),l["\u0275eld"](5,0,null,0,2,"ion-title",[],null,null,null,u.ib,u.D)),l["\u0275did"](6,49152,null,0,c.Ab,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],null,null),(n()(),l["\u0275ted"](-1,0,[" Documents "])),(n()(),l["\u0275eld"](8,0,null,0,17,"ion-buttons",[["slot","end"]],null,null,null,u.K,u.f)),l["\u0275did"](9,49152,null,0,c.l,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],null,null),(n()(),l["\u0275eld"](10,0,null,0,8,"ion-button",[["class","notification-icon-button"],["routerDirection","forward"]],null,[[null,"click"]],(function(n,e,t){var o=!0;return"click"===e&&(o=!1!==l["\u0275nov"](n,12).onClick()&&o),"click"===e&&(o=!1!==l["\u0275nov"](n,14).onClick(t)&&o),o}),u.J,u.e)),l["\u0275did"](11,49152,null,0,c.k,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{routerDirection:[0,"routerDirection"]},null),l["\u0275did"](12,16384,null,0,d.n,[d.m,d.a,[8,null],l.Renderer2,l.ElementRef],{routerLink:[0,"routerLink"]},null),l["\u0275pad"](13,1),l["\u0275did"](14,737280,null,0,c.Ob,[r.g,c.Ib,l.ElementRef,d.m,[2,d.n]],{routerDirection:[0,"routerDirection"]},null),(n()(),l["\u0275and"](16777216,null,0,1,null,_)),l["\u0275did"](16,16384,null,0,r.j,[l.ViewContainerRef,l.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),l["\u0275eld"](17,0,null,0,1,"ion-icon",[["name","notifications"],["slot","icon-only"]],null,null,null,u.Q,u.l)),l["\u0275did"](18,49152,null,0,c.C,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{name:[0,"name"]},null),(n()(),l["\u0275eld"](19,0,null,0,6,"ion-button",[["routerDirection","forward"]],null,[[null,"click"]],(function(n,e,t){var o=!0;return"click"===e&&(o=!1!==l["\u0275nov"](n,21).onClick()&&o),"click"===e&&(o=!1!==l["\u0275nov"](n,23).onClick(t)&&o),o}),u.J,u.e)),l["\u0275did"](20,49152,null,0,c.k,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{routerDirection:[0,"routerDirection"]},null),l["\u0275did"](21,16384,null,0,d.n,[d.m,d.a,[8,null],l.Renderer2,l.ElementRef],{routerLink:[0,"routerLink"]},null),l["\u0275pad"](22,1),l["\u0275did"](23,737280,null,0,c.Ob,[r.g,c.Ib,l.ElementRef,d.m,[2,d.n]],{routerDirection:[0,"routerDirection"]},null),(n()(),l["\u0275eld"](24,0,null,0,1,"ion-icon",[["name","settings"],["slot","icon-only"]],null,null,null,u.Q,u.l)),l["\u0275did"](25,49152,null,0,c.C,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{name:[0,"name"]},null),(n()(),l["\u0275eld"](26,0,null,null,13,"ion-content",[["class","documents"]],null,null,null,u.M,u.h)),l["\u0275did"](27,49152,null,0,c.u,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],null,null),(n()(),l["\u0275eld"](28,0,null,0,7,"div",[["class","documents__search"]],null,null,null,null,null)),(n()(),l["\u0275eld"](29,0,null,null,6,"ion-searchbar",[["color","light"],["placeholder","Find a document..."]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"ionChange"],[null,"ionBlur"]],(function(n,e,t){var o=!0,i=n.component;return"ionBlur"===e&&(o=!1!==l["\u0275nov"](n,30)._handleBlurEvent(t.target)&&o),"ionChange"===e&&(o=!1!==l["\u0275nov"](n,30)._handleInputEvent(t.target)&&o),"ngModelChange"===e&&(o=!1!==(i.search=t)&&o),"ionChange"===e&&(o=!1!==i.doSearch()&&o),o}),u.Y,u.t)),l["\u0275did"](30,16384,null,0,c.Qb,[l.ElementRef],null,null),l["\u0275prd"](1024,null,s.c,(function(n){return[n]}),[c.Qb]),l["\u0275did"](32,671744,null,0,s.h,[[8,null],[8,null],[8,null],[6,s.c]],{model:[0,"model"]},{update:"ngModelChange"}),l["\u0275prd"](2048,null,s.d,null,[s.h]),l["\u0275did"](34,16384,null,0,s.e,[[4,s.d]],null,null),l["\u0275did"](35,49152,null,0,c.kb,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{color:[0,"color"],placeholder:[1,"placeholder"]},null),(n()(),l["\u0275and"](16777216,null,0,1,null,w)),l["\u0275did"](37,16384,null,0,r.j,[l.ViewContainerRef,l.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),l["\u0275and"](16777216,null,0,1,null,E)),l["\u0275did"](39,16384,null,0,r.j,[l.ViewContainerRef,l.TemplateRef],{ngIf:[0,"ngIf"]},null)],(function(n,e){var t=e.component;n(e,4,0,"primary"),n(e,11,0,"forward");var l=n(e,13,0,"/messages");n(e,12,0,l),n(e,14,0,"forward"),n(e,16,0,t.unreadMessages>0),n(e,18,0,"notifications"),n(e,20,0,"forward");var o=n(e,22,0,"/settings");n(e,21,0,o),n(e,23,0,"forward"),n(e,25,0,"settings"),n(e,32,0,t.search),n(e,35,0,"light","Find a document..."),n(e,37,0,t.loading),n(e,39,0,!t.loading)}),(function(n,e){n(e,29,0,l["\u0275nov"](e,34).ngClassUntouched,l["\u0275nov"](e,34).ngClassTouched,l["\u0275nov"](e,34).ngClassPristine,l["\u0275nov"](e,34).ngClassDirty,l["\u0275nov"](e,34).ngClassValid,l["\u0275nov"](e,34).ngClassInvalid,l["\u0275nov"](e,34).ngClassPending)}))}function S(n){return l["\u0275vid"](0,[(n()(),l["\u0275eld"](0,0,null,null,1,"app-documents",[],null,null,null,P,R)),l["\u0275did"](1,49152,null,0,C,[f.a,c.Rb,c.Hb,d.m,m.a,c.a,l.NgZone,p.a,g.a,v.a,b.a,c.Lb,h.a],null,null)],null,null)}var I=l["\u0275ccf"]("app-documents",C,S,{},{},[]),k=function(){return function(){}}(),Z=t("iTUp");t.d(e,"DocumentsPageModuleNgFactory",(function(){return N}));var N=l["\u0275cmf"](o,[],(function(n){return l["\u0275mod"]([l["\u0275mpd"](512,l.ComponentFactoryResolver,l["\u0275CodegenComponentFactoryResolver"],[[8,[i.a,I]],[3,l.ComponentFactoryResolver],l.NgModuleRef]),l["\u0275mpd"](4608,r.l,r.k,[l.LOCALE_ID,[2,r.w]]),l["\u0275mpd"](4608,s.j,s.j,[]),l["\u0275mpd"](4608,c.b,c.b,[l.NgZone,l.ApplicationRef]),l["\u0275mpd"](4608,c.Hb,c.Hb,[c.b,l.ComponentFactoryResolver,l.Injector]),l["\u0275mpd"](4608,c.Mb,c.Mb,[c.b,l.ComponentFactoryResolver,l.Injector]),l["\u0275mpd"](1073742336,r.b,r.b,[]),l["\u0275mpd"](1073742336,s.i,s.i,[]),l["\u0275mpd"](1073742336,s.b,s.b,[]),l["\u0275mpd"](1073742336,c.Eb,c.Eb,[]),l["\u0275mpd"](1073742336,d.p,d.p,[[2,d.u],[2,d.m]]),l["\u0275mpd"](1073742336,k,k,[]),l["\u0275mpd"](1073742336,Z.a,Z.a,[]),l["\u0275mpd"](1073742336,o,o,[]),l["\u0275mpd"](1024,d.k,(function(){return[[{path:"",component:C}]]}),[])])}))}}]);