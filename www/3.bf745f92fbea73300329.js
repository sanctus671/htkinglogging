(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"N+xg":function(n,e,l){"use strict";l.r(e);var t=l("CcnG"),o=function(){return function(){}}(),u=l("pMnS"),i=l("oBZk"),r=l("ZZ/e"),c=l("Ip0R"),a=l("lXZ+"),d=l("ZYCi"),s=l("gIcY"),m=l("IwxM"),f=l("ri4K"),p=l("9B/o"),g=l("KOTj"),h=l("wd/R"),D=l("t8sF"),v=l("wMzM"),C=function(){function n(n,e,l,t,o,u,i,r,c,a,d,s){var m=this;this.documentService=n,this.toastController=e,this.modalController=l,this.router=t,this.authenticationService=o,this.alertCtrl=u,this.ngZone=i,this.iab=r,this.offlineService=c,this.file=a,this.fileOpener=d,this.platform=s,this.loading=!0,this.search="",this.filters={orderby:"created_at",order:"asc",city:"",suburb:""},this.documents=[],this.documentGroups=[],this.formattedDocuments={},this.user={},this.authenticationService.getUserData().subscribe((function(n){m.ngZone.run((function(){m.user=n}))})),this.offlineService.monitorUploads().subscribe((function(n){n&&n.uploaded&&m.getDocuments()}))}return n.prototype.ionViewDidEnter=function(){this.getDocuments()},n.prototype.downloadDocument=function(n){var e=this;if(n.file_blob){var l=this.b64toBlob(n.file_blob,"application/pdf",512),t=new Blob([l],{type:"application/pdf"}),o=this.platform.is("ios")?this.file.dataDirectory:this.file.externalApplicationStorageDirectory;this.file.writeFile(o,n.id+".pdf",t,{replace:!0}).then((function(l){e.fileOpener.showOpenWithDialog(o+n.id+".pdf","application/pdf").then((function(n){})).catch((function(n){alert(JSON.stringify(n))}))})).catch((function(n){alert(JSON.stringify(n))}))}else this.iab.create(n.file,"_system")},n.prototype.b64toBlob=function(n,e,l){e=e||"",l=l||512,n=(n=n.replace(/^[^,]+,/,"")).replace(/\s/g,"");for(var t=atob(n),o=[],u=0;u<t.length;u+=l){for(var i=t.slice(u,u+l),r=new Array(i.length),c=0;c<i.length;c++)r[c]=i.charCodeAt(c);var a=new Uint8Array(r);o.push(a)}return new Blob(o,{type:e})},n.prototype.getDocuments=function(){var n=this;this.loading=!0,this.offlineService.getDocumentGroups().then((function(e){e?n.setDocumentGroupData(e):n.getOnlineDocuments()})).catch((function(){n.getOnlineDocuments()}))},n.prototype.getOnlineDocuments=function(){var n=this;this.documentService.getDocumentGroups().then((function(e){n.offlineService.saveDocumentGroups(e),n.setDocumentGroupData(e)})).catch((function(){n.loading=!1}))},n.prototype.setDocumentGroupData=function(n){var e=this;this.documentGroups=n,this.documentGroups.push({name:"Other"}),this.formattedDocuments={};for(var l=0,t=this.documentGroups;l<t.length;l++)this.formattedDocuments[t[l].name]=[];this.offlineService.getDocuments().then((function(n){n?(e.setDocumentData(n),e.loading=!1):e.getOnlineDocumentGroupData()})).catch((function(){e.getOnlineDocumentGroupData()}))},n.prototype.getOnlineDocumentGroupData=function(){var n=this;this.documentService.getDocuments(this.search,this.filters).then((function(e){n.formattedDocuments={};for(var l=0,t=n.documentGroups;l<t.length;l++)n.formattedDocuments[t[l].name]=[];n.offlineService.saveDocuments(e.data),n.setDocumentData(e.data),n.loading=!1})).catch((function(){n.loading=!1}))},n.prototype.setDocumentData=function(n){this.documents=n;for(var e=0,l=this.documents;e<l.length;e++){var t=l[e];t.document_group?this.formattedDocuments[t.document_group.name].push(t):this.formattedDocuments.Other.push(t)}},n.prototype.doSearch=function(){},n.prototype.documentatDate=function(n){var e=-(new Date).getTimezoneOffset();return h(n).add(e,"m").format("DD/MM/YYYY, h:mma")},n}(),b=t["\u0275crt"]({encapsulation:0,styles:[[".documents.ios[_ngcontent-%COMP%]   .documents__search[_ngcontent-%COMP%]   .documents__search__filter[_ngcontent-%COMP%]{top:12px}.documents[_ngcontent-%COMP%]   .documents__search[_ngcontent-%COMP%]{position:relative;margin-top:10px}.documents[_ngcontent-%COMP%]   .documents__search[_ngcontent-%COMP%]   .documents__search__filter[_ngcontent-%COMP%]{position:absolute;top:7px;right:10px;font-size:10px}.documents[_ngcontent-%COMP%]   .documents__list[_ngcontent-%COMP%]{margin-top:15px}.documents[_ngcontent-%COMP%]   .documents__list[_ngcontent-%COMP%]   ion-list-header[_ngcontent-%COMP%]{font-weight:600}.documents[_ngcontent-%COMP%]   .documents__loading[_ngcontent-%COMP%]{text-align:center;margin-top:60px}"]],data:{}});function R(n){return t["\u0275vid"](0,[(n()(),t["\u0275eld"](0,0,null,null,2,"div",[["class","documents__loading"]],null,null,null,null,null)),(n()(),t["\u0275eld"](1,0,null,null,1,"ion-spinner",[["color","primary"]],null,null,null,i.bb,i.x)),t["\u0275did"](2,49152,null,0,r.sb,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],{color:[0,"color"]},null)],(function(n,e){n(e,2,0,"primary")}),null)}function _(n){return t["\u0275vid"](0,[(n()(),t["\u0275eld"](0,0,null,null,7,"ion-item",[["detail",""]],null,[[null,"click"]],(function(n,e,l){var t=!0;return"click"===e&&(t=!1!==n.component.downloadDocument(n.context.$implicit)&&t),t}),i.Q,i.m)),t["\u0275did"](1,49152,null,0,r.H,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],{detail:[0,"detail"]},null),(n()(),t["\u0275eld"](2,0,null,0,5,"ion-label",[],null,null,null,i.R,i.n)),t["\u0275did"](3,49152,null,0,r.N,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["\u0275eld"](4,0,null,0,1,"h2",[],null,null,null,null,null)),(n()(),t["\u0275ted"](5,null,["",""])),(n()(),t["\u0275eld"](6,0,null,0,1,"p",[],null,null,null,null,null)),(n()(),t["\u0275ted"](7,null,["",""]))],(function(n,e){n(e,1,0,"")}),(function(n,e){n(e,5,0,e.context.$implicit.name),n(e,7,0,e.context.$implicit.description)}))}function O(n){return t["\u0275vid"](0,[(n()(),t["\u0275eld"](0,0,null,null,7,"ion-list",[["class","documents__list"]],null,null,null,i.T,i.o)),t["\u0275did"](1,49152,null,0,r.O,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["\u0275eld"](2,0,null,0,2,"ion-list-header",[],null,null,null,i.S,i.p)),t["\u0275did"](3,49152,null,0,r.P,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["\u0275ted"](4,0,[" "," "])),(n()(),t["\u0275and"](16777216,null,0,2,null,_)),t["\u0275did"](6,278528,null,0,c.i,[t.ViewContainerRef,t.TemplateRef,t.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),t["\u0275ppd"](7,2)],(function(n,e){var l=e.component,o=t["\u0275unv"](e,6,0,n(e,7,0,t["\u0275nov"](e.parent.parent.parent,0),l.formattedDocuments[e.parent.context.$implicit.name],l.search));n(e,6,0,o)}),(function(n,e){n(e,4,0,e.parent.context.$implicit.name)}))}function y(n){return t["\u0275vid"](0,[(n()(),t["\u0275eld"](0,0,null,null,2,"div",[],null,null,null,null,null)),(n()(),t["\u0275and"](16777216,null,null,1,null,O)),t["\u0275did"](2,16384,null,0,c.j,[t.ViewContainerRef,t.TemplateRef],{ngIf:[0,"ngIf"]},null)],(function(n,e){var l=e.component;n(e,2,0,l.formattedDocuments[e.context.$implicit.name]&&l.formattedDocuments[e.context.$implicit.name].length>0)}),null)}function w(n){return t["\u0275vid"](0,[(n()(),t["\u0275eld"](0,0,null,null,2,"div",[],null,null,null,null,null)),(n()(),t["\u0275and"](16777216,null,null,1,null,y)),t["\u0275did"](2,278528,null,0,c.i,[t.ViewContainerRef,t.TemplateRef,t.IterableDiffers],{ngForOf:[0,"ngForOf"]},null)],(function(n,e){n(e,2,0,e.component.documentGroups)}),null)}function M(n){return t["\u0275vid"](0,[t["\u0275pid"](0,a.a,[]),(n()(),t["\u0275eld"](1,0,null,null,15,"ion-header",[],null,null,null,i.N,i.j)),t["\u0275did"](2,49152,null,0,r.B,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["\u0275eld"](3,0,null,0,13,"ion-toolbar",[["color","primary"]],null,null,null,i.hb,i.D)),t["\u0275did"](4,49152,null,0,r.Cb,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],{color:[0,"color"]},null),(n()(),t["\u0275eld"](5,0,null,0,2,"ion-title",[],null,null,null,i.gb,i.C)),t["\u0275did"](6,49152,null,0,r.Ab,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["\u0275ted"](-1,0,[" Documents "])),(n()(),t["\u0275eld"](8,0,null,0,8,"ion-buttons",[["slot","end"]],null,null,null,i.I,i.e)),t["\u0275did"](9,49152,null,0,r.l,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["\u0275eld"](10,0,null,0,6,"ion-button",[["routerDirection","forward"]],null,[[null,"click"]],(function(n,e,l){var o=!0;return"click"===e&&(o=!1!==t["\u0275nov"](n,12).onClick()&&o),"click"===e&&(o=!1!==t["\u0275nov"](n,14).onClick(l)&&o),o}),i.H,i.d)),t["\u0275did"](11,49152,null,0,r.k,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],{routerDirection:[0,"routerDirection"]},null),t["\u0275did"](12,16384,null,0,d.n,[d.m,d.a,[8,null],t.Renderer2,t.ElementRef],{routerLink:[0,"routerLink"]},null),t["\u0275pad"](13,1),t["\u0275did"](14,737280,null,0,r.Ob,[c.g,r.Ib,t.ElementRef,d.m,[2,d.n]],{routerDirection:[0,"routerDirection"]},null),(n()(),t["\u0275eld"](15,0,null,0,1,"ion-icon",[["name","settings"],["slot","icon-only"]],null,null,null,i.O,i.k)),t["\u0275did"](16,49152,null,0,r.C,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],{name:[0,"name"]},null),(n()(),t["\u0275eld"](17,0,null,null,13,"ion-content",[["class","documents"]],null,null,null,i.K,i.g)),t["\u0275did"](18,49152,null,0,r.u,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["\u0275eld"](19,0,null,0,7,"div",[["class","documents__search"]],null,null,null,null,null)),(n()(),t["\u0275eld"](20,0,null,null,6,"ion-searchbar",[["color","light"],["placeholder","Find a document..."]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"ionChange"],[null,"ionBlur"]],(function(n,e,l){var o=!0,u=n.component;return"ionBlur"===e&&(o=!1!==t["\u0275nov"](n,21)._handleBlurEvent(l.target)&&o),"ionChange"===e&&(o=!1!==t["\u0275nov"](n,21)._handleInputEvent(l.target)&&o),"ngModelChange"===e&&(o=!1!==(u.search=l)&&o),"ionChange"===e&&(o=!1!==u.doSearch()&&o),o}),i.W,i.s)),t["\u0275did"](21,16384,null,0,r.Qb,[t.ElementRef],null,null),t["\u0275prd"](1024,null,s.c,(function(n){return[n]}),[r.Qb]),t["\u0275did"](23,671744,null,0,s.h,[[8,null],[8,null],[8,null],[6,s.c]],{model:[0,"model"]},{update:"ngModelChange"}),t["\u0275prd"](2048,null,s.d,null,[s.h]),t["\u0275did"](25,16384,null,0,s.e,[[4,s.d]],null,null),t["\u0275did"](26,49152,null,0,r.kb,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],{color:[0,"color"],placeholder:[1,"placeholder"]},null),(n()(),t["\u0275and"](16777216,null,0,1,null,R)),t["\u0275did"](28,16384,null,0,c.j,[t.ViewContainerRef,t.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),t["\u0275and"](16777216,null,0,1,null,w)),t["\u0275did"](30,16384,null,0,c.j,[t.ViewContainerRef,t.TemplateRef],{ngIf:[0,"ngIf"]},null)],(function(n,e){var l=e.component;n(e,4,0,"primary"),n(e,11,0,"forward");var t=n(e,13,0,"/settings");n(e,12,0,t),n(e,14,0,"forward"),n(e,16,0,"settings"),n(e,23,0,l.search),n(e,26,0,"light","Find a document..."),n(e,28,0,l.loading),n(e,30,0,!l.loading)}),(function(n,e){n(e,20,0,t["\u0275nov"](e,25).ngClassUntouched,t["\u0275nov"](e,25).ngClassTouched,t["\u0275nov"](e,25).ngClassPristine,t["\u0275nov"](e,25).ngClassDirty,t["\u0275nov"](e,25).ngClassValid,t["\u0275nov"](e,25).ngClassInvalid,t["\u0275nov"](e,25).ngClassPending)}))}function E(n){return t["\u0275vid"](0,[(n()(),t["\u0275eld"](0,0,null,null,1,"app-documents",[],null,null,null,M,b)),t["\u0275did"](1,49152,null,0,C,[m.a,r.Rb,r.Hb,d.m,f.a,r.a,t.NgZone,p.a,g.a,D.a,v.a,r.Lb],null,null)],null,null)}var N=t["\u0275ccf"]("app-documents",C,E,{},{},[]),Z=function(){return function(){}}(),x=l("iTUp");l.d(e,"DocumentsPageModuleNgFactory",(function(){return P}));var P=t["\u0275cmf"](o,[],(function(n){return t["\u0275mod"]([t["\u0275mpd"](512,t.ComponentFactoryResolver,t["\u0275CodegenComponentFactoryResolver"],[[8,[u.a,N]],[3,t.ComponentFactoryResolver],t.NgModuleRef]),t["\u0275mpd"](4608,c.l,c.k,[t.LOCALE_ID,[2,c.w]]),t["\u0275mpd"](4608,s.j,s.j,[]),t["\u0275mpd"](4608,r.b,r.b,[t.NgZone,t.ApplicationRef]),t["\u0275mpd"](4608,r.Hb,r.Hb,[r.b,t.ComponentFactoryResolver,t.Injector]),t["\u0275mpd"](4608,r.Mb,r.Mb,[r.b,t.ComponentFactoryResolver,t.Injector]),t["\u0275mpd"](1073742336,c.b,c.b,[]),t["\u0275mpd"](1073742336,s.i,s.i,[]),t["\u0275mpd"](1073742336,s.b,s.b,[]),t["\u0275mpd"](1073742336,r.Eb,r.Eb,[]),t["\u0275mpd"](1073742336,d.p,d.p,[[2,d.u],[2,d.m]]),t["\u0275mpd"](1073742336,Z,Z,[]),t["\u0275mpd"](1073742336,x.a,x.a,[]),t["\u0275mpd"](1073742336,o,o,[]),t["\u0275mpd"](1024,d.k,(function(){return[[{path:"",component:C}]]}),[])])}))}}]);