(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"N+xg":function(n,e,t){"use strict";t.r(e);var l=t("CcnG"),o=function(){return function(){}}(),u=t("pMnS"),i=t("oBZk"),r=t("ZZ/e"),c=t("Ip0R"),a=t("ZYCi"),d=t("gIcY"),s=t("AytR"),m=t("t/Na"),f=t("iw74"),p=function(){function n(n,e){this.http=n,this.storage=e}return n.prototype.getDocuments=function(n,e){var t=this;return new Promise((function(e,l){t.storage.get("ht_token").then((function(o){o?t.http.get(s.a.apiUrl+"/documents?token="+o+"&search="+n+"&limit=999&page=1&order_by=name&order=ASC&offline=1").subscribe((function(n){e(n)}),(function(n){l(n)})):l()}))}))},n.prototype.getDocumentGroups=function(){var n=this;return new Promise((function(e,t){n.storage.get("ht_token").then((function(l){l?n.http.get(s.a.apiUrl+"/documentgroups?token="+l).subscribe((function(n){e(n)}),(function(n){t(n)})):t()}))}))},n.prototype.getDocument=function(n){var e=this;return new Promise((function(t,l){e.storage.get("ht_token").then((function(o){o?e.http.get(s.a.apiUrl+"/documents/"+n+"?token="+o).subscribe((function(n){t(n)}),(function(n){l(n)})):l()}))}))},n.ngInjectableDef=l["\u0275\u0275defineInjectable"]({factory:function(){return new n(l["\u0275\u0275inject"](m.c),l["\u0275\u0275inject"](f.b))},token:n,providedIn:"root"}),n}(),g=t("ri4K"),h=t("9B/o"),v=t("KOTj"),b=t("wd/R"),D=function(){function n(n,e,t,l,o,u,i,r,c){var a=this;this.documentService=n,this.toastController=e,this.modalController=t,this.router=l,this.authenticationService=o,this.alertCtrl=u,this.ngZone=i,this.iab=r,this.offlineSerivce=c,this.loading=!0,this.search="",this.filters={orderby:"created_at",order:"asc",city:"",suburb:""},this.documents=[],this.documentGroups=[],this.formattedDocuments={},this.user={},this.authenticationService.getUserData().subscribe((function(n){a.ngZone.run((function(){a.user=n}))}))}return n.prototype.ionViewDidEnter=function(){this.getDocuments()},n.prototype.downloadDocument=function(n){if(n.file_blob){var e=this.b64toBlob(n.file_blob,"application/pdf",512),t=new Blob([e],{type:"application/pdf"}),l=URL.createObjectURL(t);this.iab.create(l,"_system")}else this.iab.create(n.file,"_system")},n.prototype.b64toBlob=function(n,e,t){e=e||"",t=t||512,n=(n=n.replace(/^[^,]+,/,"")).replace(/\s/g,"");for(var l=atob(n),o=[],u=0;u<l.length;u+=t){for(var i=l.slice(u,u+t),r=new Array(i.length),c=0;c<i.length;c++)r[c]=i.charCodeAt(c);var a=new Uint8Array(r);o.push(a)}return new Blob(o,{type:e})},n.prototype.getDocuments=function(){var n=this;this.loading=!0,this.documentService.getDocumentGroups().then((function(e){n.offlineSerivce.saveDocumentGroups(e),n.setDocumentGroupData(e)})).catch((function(){n.offlineSerivce.getDocumentGroups().then((function(e){e&&n.setDocumentGroupData(e)}))}))},n.prototype.setDocumentGroupData=function(n){var e=this;this.documentGroups=n,this.documentGroups.push({name:"Other"});for(var t=0,l=this.documentGroups;t<l.length;t++)this.formattedDocuments[l[t].name]=[];this.offlineSerivce.getDocuments().then((function(n){n&&(e.setDocumentData(n),e.loading=!1)})),this.documentService.getDocuments(this.search,this.filters).then((function(n){for(var t=0,l=e.documentGroups;t<l.length;t++)e.formattedDocuments[l[t].name]=[];e.offlineSerivce.saveDocuments(n.data),e.setDocumentData(n.data),e.loading=!1})).catch((function(){e.loading=!1}))},n.prototype.setDocumentData=function(n){this.documents=n;for(var e=0,t=this.documents;e<t.length;e++){var l=t[e];l.document_group?this.formattedDocuments[l.document_group.name].push(l):this.formattedDocuments.Other.push(l)}},n.prototype.doSearch=function(){this.getDocuments()},n.prototype.documentatDate=function(n){var e=-(new Date).getTimezoneOffset();return b(n).add(e,"m").format("DD/MM/YYYY, h:mma")},n}(),C=l["\u0275crt"]({encapsulation:0,styles:[[".documents.ios[_ngcontent-%COMP%]   .documents__search[_ngcontent-%COMP%]   .documents__search__filter[_ngcontent-%COMP%]{top:12px}.documents[_ngcontent-%COMP%]   .documents__search[_ngcontent-%COMP%]{position:relative;margin-top:10px}.documents[_ngcontent-%COMP%]   .documents__search[_ngcontent-%COMP%]   .documents__search__filter[_ngcontent-%COMP%]{position:absolute;top:7px;right:10px;font-size:10px}.documents[_ngcontent-%COMP%]   .documents__list[_ngcontent-%COMP%]{margin-top:15px}.documents[_ngcontent-%COMP%]   .documents__list[_ngcontent-%COMP%]   ion-list-header[_ngcontent-%COMP%]{font-weight:600}.documents[_ngcontent-%COMP%]   .documents__loading[_ngcontent-%COMP%]{text-align:center;margin-top:60px}"]],data:{}});function _(n){return l["\u0275vid"](0,[(n()(),l["\u0275eld"](0,0,null,null,2,"div",[["class","documents__loading"]],null,null,null,null,null)),(n()(),l["\u0275eld"](1,0,null,null,1,"ion-spinner",[["color","primary"]],null,null,null,i.V,i.u)),l["\u0275did"](2,49152,null,0,r.rb,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{color:[0,"color"]},null)],(function(n,e){n(e,2,0,"primary")}),null)}function R(n){return l["\u0275vid"](0,[(n()(),l["\u0275eld"](0,0,null,null,7,"ion-item",[["detail",""]],null,[[null,"click"]],(function(n,e,t){var l=!0;return"click"===e&&(l=!1!==n.component.downloadDocument(n.context.$implicit)&&l),l}),i.M,i.l)),l["\u0275did"](1,49152,null,0,r.G,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{detail:[0,"detail"]},null),(n()(),l["\u0275eld"](2,0,null,0,5,"ion-label",[],null,null,null,i.N,i.m)),l["\u0275did"](3,49152,null,0,r.M,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],null,null),(n()(),l["\u0275eld"](4,0,null,0,1,"h2",[],null,null,null,null,null)),(n()(),l["\u0275ted"](5,null,["",""])),(n()(),l["\u0275eld"](6,0,null,0,1,"p",[],null,null,null,null,null)),(n()(),l["\u0275ted"](7,null,["",""]))],(function(n,e){n(e,1,0,"")}),(function(n,e){n(e,5,0,e.context.$implicit.name),n(e,7,0,e.context.$implicit.description)}))}function y(n){return l["\u0275vid"](0,[(n()(),l["\u0275eld"](0,0,null,null,6,"ion-list",[["class","documents__list"]],null,null,null,i.P,i.n)),l["\u0275did"](1,49152,null,0,r.N,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],null,null),(n()(),l["\u0275eld"](2,0,null,0,2,"ion-list-header",[],null,null,null,i.O,i.o)),l["\u0275did"](3,49152,null,0,r.O,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],null,null),(n()(),l["\u0275ted"](4,0,[" "," "])),(n()(),l["\u0275and"](16777216,null,0,1,null,R)),l["\u0275did"](6,278528,null,0,c.i,[l.ViewContainerRef,l.TemplateRef,l.IterableDiffers],{ngForOf:[0,"ngForOf"]},null)],(function(n,e){n(e,6,0,e.component.formattedDocuments[e.parent.context.$implicit.name])}),(function(n,e){n(e,4,0,e.parent.context.$implicit.name)}))}function w(n){return l["\u0275vid"](0,[(n()(),l["\u0275eld"](0,0,null,null,2,"div",[],null,null,null,null,null)),(n()(),l["\u0275and"](16777216,null,null,1,null,y)),l["\u0275did"](2,16384,null,0,c.j,[l.ViewContainerRef,l.TemplateRef],{ngIf:[0,"ngIf"]},null)],(function(n,e){var t=e.component;n(e,2,0,t.formattedDocuments[e.context.$implicit.name]&&t.formattedDocuments[e.context.$implicit.name].length>0)}),null)}function O(n){return l["\u0275vid"](0,[(n()(),l["\u0275eld"](0,0,null,null,2,"div",[],null,null,null,null,null)),(n()(),l["\u0275and"](16777216,null,null,1,null,w)),l["\u0275did"](2,278528,null,0,c.i,[l.ViewContainerRef,l.TemplateRef,l.IterableDiffers],{ngForOf:[0,"ngForOf"]},null)],(function(n,e){n(e,2,0,e.component.documentGroups)}),null)}function M(n){return l["\u0275vid"](0,[(n()(),l["\u0275eld"](0,0,null,null,15,"ion-header",[],null,null,null,i.J,i.i)),l["\u0275did"](1,49152,null,0,r.A,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],null,null),(n()(),l["\u0275eld"](2,0,null,0,13,"ion-toolbar",[["color","primary"]],null,null,null,i.bb,i.A)),l["\u0275did"](3,49152,null,0,r.Bb,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{color:[0,"color"]},null),(n()(),l["\u0275eld"](4,0,null,0,2,"ion-title",[],null,null,null,i.ab,i.z)),l["\u0275did"](5,49152,null,0,r.zb,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],null,null),(n()(),l["\u0275ted"](-1,0,[" Documents "])),(n()(),l["\u0275eld"](7,0,null,0,8,"ion-buttons",[["slot","end"]],null,null,null,i.F,i.e)),l["\u0275did"](8,49152,null,0,r.k,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],null,null),(n()(),l["\u0275eld"](9,0,null,0,6,"ion-button",[["routerDirection","forward"]],null,[[null,"click"]],(function(n,e,t){var o=!0;return"click"===e&&(o=!1!==l["\u0275nov"](n,11).onClick()&&o),"click"===e&&(o=!1!==l["\u0275nov"](n,13).onClick(t)&&o),o}),i.E,i.d)),l["\u0275did"](10,49152,null,0,r.j,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{routerDirection:[0,"routerDirection"]},null),l["\u0275did"](11,16384,null,0,a.n,[a.m,a.a,[8,null],l.Renderer2,l.ElementRef],{routerLink:[0,"routerLink"]},null),l["\u0275pad"](12,1),l["\u0275did"](13,737280,null,0,r.Nb,[c.g,r.Hb,l.ElementRef,a.m,[2,a.n]],{routerDirection:[0,"routerDirection"]},null),(n()(),l["\u0275eld"](14,0,null,0,1,"ion-icon",[["name","settings"],["slot","icon-only"]],null,null,null,i.K,i.j)),l["\u0275did"](15,49152,null,0,r.B,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{name:[0,"name"]},null),(n()(),l["\u0275eld"](16,0,null,null,13,"ion-content",[["class","documents"]],null,null,null,i.G,i.f)),l["\u0275did"](17,49152,null,0,r.t,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],null,null),(n()(),l["\u0275eld"](18,0,null,0,7,"div",[["class","documents__search"]],null,null,null,null,null)),(n()(),l["\u0275eld"](19,0,null,null,6,"ion-searchbar",[["color","light"],["placeholder","Find a document..."]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"ionChange"],[null,"ionBlur"]],(function(n,e,t){var o=!0,u=n.component;return"ionBlur"===e&&(o=!1!==l["\u0275nov"](n,20)._handleBlurEvent(t.target)&&o),"ionChange"===e&&(o=!1!==l["\u0275nov"](n,20)._handleInputEvent(t.target)&&o),"ngModelChange"===e&&(o=!1!==(u.search=t)&&o),"ionChange"===e&&(o=!1!==u.doSearch()&&o),o}),i.S,i.r)),l["\u0275did"](20,16384,null,0,r.Pb,[l.ElementRef],null,null),l["\u0275prd"](1024,null,d.c,(function(n){return[n]}),[r.Pb]),l["\u0275did"](22,671744,null,0,d.h,[[8,null],[8,null],[8,null],[6,d.c]],{model:[0,"model"]},{update:"ngModelChange"}),l["\u0275prd"](2048,null,d.d,null,[d.h]),l["\u0275did"](24,16384,null,0,d.e,[[4,d.d]],null,null),l["\u0275did"](25,49152,null,0,r.jb,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{color:[0,"color"],placeholder:[1,"placeholder"]},null),(n()(),l["\u0275and"](16777216,null,0,1,null,_)),l["\u0275did"](27,16384,null,0,c.j,[l.ViewContainerRef,l.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),l["\u0275and"](16777216,null,0,1,null,O)),l["\u0275did"](29,16384,null,0,c.j,[l.ViewContainerRef,l.TemplateRef],{ngIf:[0,"ngIf"]},null)],(function(n,e){var t=e.component;n(e,3,0,"primary"),n(e,10,0,"forward");var l=n(e,12,0,"/settings");n(e,11,0,l),n(e,13,0,"forward"),n(e,15,0,"settings"),n(e,22,0,t.search),n(e,25,0,"light","Find a document..."),n(e,27,0,t.loading),n(e,29,0,!t.loading)}),(function(n,e){n(e,19,0,l["\u0275nov"](e,24).ngClassUntouched,l["\u0275nov"](e,24).ngClassTouched,l["\u0275nov"](e,24).ngClassPristine,l["\u0275nov"](e,24).ngClassDirty,l["\u0275nov"](e,24).ngClassValid,l["\u0275nov"](e,24).ngClassInvalid,l["\u0275nov"](e,24).ngClassPending)}))}function P(n){return l["\u0275vid"](0,[(n()(),l["\u0275eld"](0,0,null,null,1,"app-documents",[],null,null,null,M,C)),l["\u0275did"](1,49152,null,0,D,[p,r.Qb,r.Gb,a.m,g.a,r.a,l.NgZone,h.a,v.a],null,null)],null,null)}var k=l["\u0275ccf"]("app-documents",D,P,{},{},[]),N=function(){return function(){}}();t.d(e,"DocumentsPageModuleNgFactory",(function(){return E}));var E=l["\u0275cmf"](o,[],(function(n){return l["\u0275mod"]([l["\u0275mpd"](512,l.ComponentFactoryResolver,l["\u0275CodegenComponentFactoryResolver"],[[8,[u.a,k]],[3,l.ComponentFactoryResolver],l.NgModuleRef]),l["\u0275mpd"](4608,c.l,c.k,[l.LOCALE_ID,[2,c.t]]),l["\u0275mpd"](4608,d.j,d.j,[]),l["\u0275mpd"](4608,r.b,r.b,[l.NgZone,l.ApplicationRef]),l["\u0275mpd"](4608,r.Gb,r.Gb,[r.b,l.ComponentFactoryResolver,l.Injector]),l["\u0275mpd"](4608,r.Lb,r.Lb,[r.b,l.ComponentFactoryResolver,l.Injector]),l["\u0275mpd"](1073742336,c.b,c.b,[]),l["\u0275mpd"](1073742336,d.i,d.i,[]),l["\u0275mpd"](1073742336,d.b,d.b,[]),l["\u0275mpd"](1073742336,r.Db,r.Db,[]),l["\u0275mpd"](1073742336,a.p,a.p,[[2,a.u],[2,a.m]]),l["\u0275mpd"](1073742336,N,N,[]),l["\u0275mpd"](1073742336,o,o,[]),l["\u0275mpd"](1024,a.k,(function(){return[[{path:"",component:D}]]}),[])])}))}}]);