{"version":3,"sources":["./src/app/pages/forms/forms.page.html","./src/app/pages/forms/forms.module.ts","./src/app/pages/forms/forms.page.scss","./src/app/pages/forms/forms.page.ts"],"names":[],"mappings":"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","file":"forms-forms-module.js","sourcesContent":["module.exports = \"<ion-header>\\n    <ion-toolbar color=\\\"primary\\\">\\n        <ion-title>\\n            Forms\\n        </ion-title>\\n        \\n        <ion-buttons slot=\\\"end\\\">\\n            <ion-button [routerLink]=\\\"['/settings']\\\" routerDirection=\\\"forward\\\">\\n                <ion-icon slot=\\\"icon-only\\\" name=\\\"settings\\\"></ion-icon>\\n            </ion-button>   \\n            \\n        </ion-buttons>            \\n        \\n    </ion-toolbar>\\n</ion-header>\\n\\n<ion-content class=\\\"forms\\\">\\n\\n\\n    <div class=\\\"forms__search\\\">\\n        <ion-searchbar placeholder=\\\"Find a form...\\\" [(ngModel)]=\\\"search\\\" (ionChange)=\\\"doSearch()\\\" color=\\\"light\\\"></ion-searchbar>      \\n    </div>\\n\\n        \\n    <div class=\\\"forms__loading\\\" *ngIf=\\\"loading\\\">\\n        <ion-spinner color=\\\"primary\\\"></ion-spinner>\\n    </div>    \\n        \\n    \\n    <div *ngIf=\\\"!loading\\\">\\n    \\n        <div  *ngFor=\\\"let formGroup of formGroups\\\">\\n            <ion-list class=\\\"forms__list\\\" *ngIf=\\\"formattedForms[formGroup.name] && formattedForms[formGroup.name].length > 0\\\">\\n\\n                <ion-list-header>\\n                    {{formGroup.name}}\\n                </ion-list-header>\\n\\n                <ion-item detail *ngFor=\\\"let form of formattedForms[formGroup.name]\\\"  [routerLink]=\\\"['/form/' + form.id]\\\" routerDirection=\\\"forward\\\">\\n                    <ion-label>\\n                        <h2>{{form.name}}</h2>\\n                        <p *ngIf=\\\"form.last_submission\\\">Last submitted {{formatDate(form.last_submission.created_at)}}</p>\\n                        <p *ngIf=\\\"!form.last_submission\\\">Tap to start this form</p>\\n                    </ion-label>\\n                </ion-item>       \\n\\n\\n            </ion-list>    \\n\\n        </div>\\n        \\n    </div>\\n\\n\\n\\n    \\n</ion-content>\\n\"","import { IonicModule } from '@ionic/angular';\nimport { RouterModule } from '@angular/router';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { FormsPage } from './forms.page';\n\n@NgModule({\n  imports: [\n    IonicModule,\n    CommonModule,\n    FormsModule,\n    RouterModule.forChild([{ path: '', component: FormsPage }])\n  ],\n  declarations: [FormsPage]\n})\nexport class FormsPageModule {}\n","module.exports = \".forms.ios .forms__search .forms__search__filter {\\n  top: 12px;\\n}\\n.forms .forms__search {\\n  position: relative;\\n  margin-top: 10px;\\n}\\n.forms .forms__search .forms__search__filter {\\n  position: absolute;\\n  top: 7px;\\n  right: 10px;\\n  font-size: 10px;\\n}\\n.forms .forms__list {\\n  margin-top: 15px;\\n}\\n.forms .forms__list ion-list-header {\\n  font-weight: 600;\\n}\\n.forms .forms__loading {\\n  text-align: center;\\n  margin-top: 60px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvZm9ybXMvRDpcXFRheWxvclxcRG9jdW1lbnRzXFxXZWJzaXRlc1xcaHRraW5nbG9nZ2luZ1xcYXBwL3NyY1xcYXBwXFxwYWdlc1xcZm9ybXNcXGZvcm1zLnBhZ2Uuc2NzcyIsInNyYy9hcHAvcGFnZXMvZm9ybXMvZm9ybXMucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQU1RO0VBQ0ksU0FBQTtBQ0xaO0FEV0k7RUFDSSxrQkFBQTtFQUNBLGdCQUFBO0FDVFI7QURXUTtFQUNJLGtCQUFBO0VBQ0EsUUFBQTtFQUNBLFdBQUE7RUFDQSxlQUFBO0FDVFo7QURlSTtFQUNJLGdCQUFBO0FDYlI7QURlUTtFQUNRLGdCQUFBO0FDYmhCO0FEb0JJO0VBQ0ksa0JBQUE7RUFDQSxnQkFBQTtBQ2xCUiIsImZpbGUiOiJzcmMvYXBwL3BhZ2VzL2Zvcm1zL2Zvcm1zLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5mb3Jtc3tcbiAgICBcbiAgICAmLmlvc3tcbiAgICAgICAgXG5cbiAgICAgICAgXG4gICAgICAgIC5mb3Jtc19fc2VhcmNoIC5mb3Jtc19fc2VhcmNoX19maWx0ZXJ7XG4gICAgICAgICAgICB0b3A6MTJweDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICB9XG4gICAgXG5cbiAgICAuZm9ybXNfX3NlYXJjaHtcbiAgICAgICAgcG9zaXRpb246cmVsYXRpdmU7XG4gICAgICAgIG1hcmdpbi10b3A6IDEwcHg7XG4gICAgXG4gICAgICAgIC5mb3Jtc19fc2VhcmNoX19maWx0ZXJ7XG4gICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgICAgICB0b3A6IDdweDtcbiAgICAgICAgICAgIHJpZ2h0OiAxMHB4O1xuICAgICAgICAgICAgZm9udC1zaXplOiAxMHB4O1xuXG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgXG4gICAgLmZvcm1zX19saXN0e1xuICAgICAgICBtYXJnaW4tdG9wOiAxNXB4O1xuICAgICAgICBcbiAgICAgICAgaW9uLWxpc3QtaGVhZGVye1xuICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfVxuICAgIFxuICAgIFxuICAgIFxuICAgIC5mb3Jtc19fbG9hZGluZ3tcbiAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICBtYXJnaW4tdG9wOiA2MHB4OyAgICAgICAgXG4gICAgfVxuICAgXG59XG4iLCIuZm9ybXMuaW9zIC5mb3Jtc19fc2VhcmNoIC5mb3Jtc19fc2VhcmNoX19maWx0ZXIge1xuICB0b3A6IDEycHg7XG59XG4uZm9ybXMgLmZvcm1zX19zZWFyY2gge1xuICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gIG1hcmdpbi10b3A6IDEwcHg7XG59XG4uZm9ybXMgLmZvcm1zX19zZWFyY2ggLmZvcm1zX19zZWFyY2hfX2ZpbHRlciB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgdG9wOiA3cHg7XG4gIHJpZ2h0OiAxMHB4O1xuICBmb250LXNpemU6IDEwcHg7XG59XG4uZm9ybXMgLmZvcm1zX19saXN0IHtcbiAgbWFyZ2luLXRvcDogMTVweDtcbn1cbi5mb3JtcyAuZm9ybXNfX2xpc3QgaW9uLWxpc3QtaGVhZGVyIHtcbiAgZm9udC13ZWlnaHQ6IDYwMDtcbn1cbi5mb3JtcyAuZm9ybXNfX2xvYWRpbmcge1xuICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gIG1hcmdpbi10b3A6IDYwcHg7XG59Il19 */\"","import { Component, NgZone } from '@angular/core';\nimport {FormService} from '../../services/form/form.service';\nimport {AuthenticationService} from '../../services/authentication/authentication.service';\nimport { ToastController, ModalController,AlertController } from '@ionic/angular';\nimport { Router, RouterEvent, NavigationEnd } from '@angular/router';\nimport {OfflineService} from '../../services/offline/offline.service';\n\nimport * as moment from 'moment';\n\n@Component({\n    selector: 'app-forms',\n    templateUrl: 'forms.page.html',\n    styleUrls: ['forms.page.scss']\n})\nexport class FormsPage {\n  \n    public search:string;\n    public filters:any;\n    public loading:boolean;\n    \n    public user:any;\n    \n    public forms:Array<any>;\n    public formGroups:Array<any>;\n    public formattedForms:any;\n    \n    constructor(private formService:FormService, public toastController: ToastController, public modalController: ModalController,\n        private router: Router, private authenticationService:AuthenticationService, private alertCtrl: AlertController, \n        private ngZone: NgZone, private offlineSerivce: OfflineService) {\n\n        this.loading = true;\n        \n        this.search = \"\";\n        this.filters = {orderby:\"created_at\", order:\"asc\", city:\"\", suburb:\"\"}        \n        \n        this.forms = [];\n        this.formGroups = [];\n        this.formattedForms = {};\n\n        this.user = {};\n        this.authenticationService.getUserData().subscribe((data) => {\n\n            this.ngZone.run(() => {\n                this.user = data;\n            });\n        });\n       \n        \n        \n    }\n    \n    ionViewDidEnter(){\n        this.getForms();\n    }\n    \n    \n    public getForms(){\n        this.formService.getFormGroups().then((data:any) => {\n            \n            this.offlineSerivce.saveFormGroups(data);\n            \n            this.setFormGroupData(data);\n            \n            \n        }).catch(() => {\n            this.offlineSerivce.getFormGroups().then((data) => {\n                if (data){\n                    this.setFormGroupData(data);\n                }\n            })            \n        })\n\n    }\n    \n    \n    private setFormGroupData(data){\n        \n            this.formGroups = data;\n            \n            this.formGroups.push({name:\"Other\"})\n            \n            for (let formGroup of this.formGroups){\n                this.formattedForms[formGroup.name] = [];\n            }\n            \n            this.formService.getForms(this.search, this.filters).then((data:any) => {\n                \n                this.offlineSerivce.saveForms(data.data);\n                \n                this.setFormData(data.data);\n                \n                this.loading = false;\n            }).catch(() => {\n            \n                this.offlineSerivce.getForms().then((data) => {\n                    if (data){\n                        this.setFormData(data);\n                    }\n                });\n            \n                this.loading = false;\n            });            \n                    \n    }\n    \n    \n    private setFormData(data){\n        this.forms = data;\n\n        for (let form of this.forms){\n            if (form.form_group){\n                this.formattedForms[form.form_group.name].push(form);\n            }\n            else{\n                this.formattedForms[\"Other\"].push(form);\n            }\n        }          \n    }\n    \n \n    \n    \n    public doSearch(){\n        this.loading = true;\n        this.getForms();\n        \n    }    \n    \n\n    \n    \n    public formatDate(date){\n        let localeOffset = -(new Date().getTimezoneOffset());\n        return moment(date).add(localeOffset, 'm').fromNow();\n    }       \n    \n\n}\n"],"sourceRoot":""}